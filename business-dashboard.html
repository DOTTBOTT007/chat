<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Management Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.0.0/dist/umd/supabase.min.js"></script>

    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    
    <!-- Chart.js for Visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --background-color: #f4f6f7;
            --card-background: #ffffff;
            --text-color: #2c3e50;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--background-color);
            display: flex;
            height: 100vh;
            color: var(--text-color);
        }

        /* Hamburger Menu Button */
        .hamburger-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1000;
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
        }

        /* Sidebar Styling */
        .sidebar {
            width: 250px;
            background-color: var(--primary-color);
            padding: 20px;
            display: flex;
            flex-direction: column;
            color: white;
            transition: transform 0.3s ease;
        }

        .sidebar-title {
            font-size: 1.5rem;
            margin-bottom: 30px;
            text-align: center;
            font-weight: bold;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 15px;
        }

        .sidebar-menu button {
            width: 100%;
            padding: 10px;
            background-color: rgba(255,255,255,0.2);
            border: none;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .sidebar-menu button:hover {
            background-color: rgba(255,255,255,0.3);
        }

        /* Main Content Area */
        .main-content {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            margin-left: 250px;
            transition: margin-left 0.3s ease;
        }

        .form-container {
            background-color: var(--card-background);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input, 
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .btn {
            display: inline-block;
            padding: 10px 15px;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .btn:hover {
            background-color: #27ae60;
        }

        /* Table Styling */
        .table-container {
            background-color: var(--card-background);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table th, table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        table th {
            background-color: var(--primary-color);
            color: white;
        }

        /* Chart Container */
        .chart-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .chart-card {
            background-color: var(--card-background);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* Responsive Styles */
        @media screen and (max-width: 768px) {
            body {
                flex-direction: column;
            }

            .hamburger-btn {
                display: block;
            }

            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                transform: translateX(-100%);
                z-index: 999;
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding-top: 60px;
            }

            .chart-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Hamburger Menu Button -->
    <button class="hamburger-btn" onclick="toggleSidebar()">â˜° Menu</button>

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-title">Business Dashboard</div>
        <ul class="sidebar-menu">
            <li><button onclick="showSection('order')">Add Order</button></li>
            <li><button onclick="showSection('expense')">Add Expense</button></li>
            <li><button onclick="showSection('order-table')">Order Table</button></li>
            <li><button onclick="showSection('expense-table')">Expense Table</button></li>
            <li><button onclick="showSection('analytics')">Analytics</button></li>
        </ul>
    </div>

    <!-- Main Content Area -->
    <div class="main-content">
        <!-- Order Form Section -->
        <div id="order-section" class="form-container" style="display:none;">
            <h2>Add Order</h2>
            <form id="order-form">
                <div class="form-group">
                    <label>Order Name</label>
                    <input type="text" id="order-name" required>
                </div>
                <div class="form-group">
                    <label>SKU</label>
                    <select id="order-sku" required>
                        <option value="001">001</option>
                        <option value="002">002</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Payer</label>
                    <select id="order-payer" required>
                        <option value="Gaurang">Gaurang</option>
                        <option value="Sumit">Sumit</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Amount</label>
                    <input type="number" id="order-amount" required>
                </div>
                <button type="submit" class="btn">Add Order</button>
            </form>
        </div>

        <!-- Expense Form Section -->
        <div id="expense-section" class="form-container" style="display:none;">
            <h2>Add Expense</h2>
            <form id="expense-form">
                <div class="form-group">
                    <label>Expense Type</label>
                    <select id="expense-type" required>
                        <option value="petrol">Petrol</option>
                        <option value="tap">Tap</option>
                        <option value="flip-cart-bag">Flip Cart Bag</option>
                        <option value="amazon-bag">Amazon Bag</option>
                        <option value="website-expense">Website Expense</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Amount</label>
                    <input type="number" id="expense-amount" required>
                </div>
                <button type="submit" class="btn">Add Expense</button>
            </form>
        </div>

        <!-- Order Table Section -->
        <div id="order-table-section" class="table-container" style="display:none;">
            <h2>Order Table</h2>
            <table id="order-table">
                <thead>
                    <tr>
                        <th>Order Name</th>
                        <th>SKU</th>
                        <th>Payer</th>
                        <th>Amount</th>
                        <th>Created At</th>
                        <th>Updated At</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="order-table-body"></tbody>
            </table>
        </div>

        <!-- Expense Table Section -->
        <div id="expense-table-section" class="table-container" style="display:none;">
            <h2>Expense Table</h2>
            <table id="expense-table">
                <thead>
                    <tr>
                        <th>Expense Type</th>
                        <th>Amount</th>
                        <th>Created At</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="expense-table-body"></tbody>
            </table>
        </div>

        <!-- Analytics Section -->
        <div id="analytics-section" class="chart-container" style="display:none;">
            <div class="chart-card">
                <h2>Order Analytics</h2>
                <canvas id="order-chart"></canvas>
            </div>
            <div class="chart-card">
                <h2>Expense Analytics</h2>
                <canvas id="expense-chart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://jaykercqfzzwjivuzkpj.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpheWtlcmNxZnp6d2ppdnV6a3BqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI4NDUyMDgsImV4cCI6MjA1ODQyMTIwOH0.FEw7uHf0zia6NTW4Npy6JA1o3b8lrBbVc70CRLRBuA4';
        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Toggle Sidebar
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            sidebar.classList.toggle('active');
        }

        // Close Sidebar on Menu Item Click
        document.querySelectorAll('.sidebar-menu button').forEach(button => {
            button.addEventListener('click', () => {
                if (window.innerWidth <= 768) {
                    document.querySelector('.sidebar').classList.remove('active');
                }
            });
        });

        // Show Sections
        function showSection(section) {
            // Hide all sections
            ['order', 'expense', 'order-table', 'expense-table', 'analytics']
                .forEach(s => document.getElementById(`${s}-section`).style.display = 'none');
            
            // Show selected section
            document.getElementById(`${section}-section`).style.display = 'block';

            // Fetch data for tables
            if (section === 'order-table') fetchOrders();
            if (section === 'expense-table') fetchExpenses();
            if (section === 'analytics') renderAnalytics();
        }

        // Order Form Submission
        document.getElementById('order-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const orderName = document.getElementById('order-name').value;
            const orderSku = document.getElementById('order-sku').value;
            const orderPayer = document.getElementById('order-payer').value;
            const orderAmount = parseFloat(document.getElementById('order-amount').value);

            const { data, error } = await supabase
                .from('orders')
                .insert([{
                    order_name: orderName,
                    sku: orderSku,
                    payer: orderPayer,
                    amount: orderAmount,
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                }]);

            if (error) {
                alert('Error adding order: ' + error.message);
            } else {
                alert('Order added successfully!');
                fetchOrders();
            }
        });

        // Expense Form Submission
        document.getElementById('expense-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const expenseType = document.getElementById('expense-type').value;
            const expenseAmount = parseFloat(document.getElementById('expense-amount').value);

            const { data, error } = await supabase
                .from('expenses')
                .insert([{
                    expense_type: expenseType,
                    amount: expenseAmount,
                    created_at: new Date().toISOString()
                }]);

            if (error) {
                alert('Error adding expense: ' + error.message);
            } else {
                alert('Expense added successfully!');
                fetchExpenses();
            }
        });

        // Fetch Orders
        async function fetchOrders() {
            const { data: orders, error } = await supabase
                .from('orders')
                .select('*')
                .order('created_at', { ascending: false });

            const tableBody = document.getElementById('order-table-body');
            tableBody.innerHTML = '';

            orders.forEach(order => {
                const row = `
                    <tr>
                        <td>${order.order_name}</td>
                        <td>${order.sku}</td>
                        <td>${order.payer}</td>
                        <td>${order.amount}</td>
                        <td>${new Date(order.created_at).toLocaleString()}</td>
                        <td>${new Date(order.updated_at).toLocaleString()}</td>
                        <td>
                            <button onclick="editOrder(${order.id})">Edit</button>
                            <button onclick="deleteOrder(${order.id})">Delete</button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }

        // Fetch Expenses
        async function fetchExpenses() {
            const { data: expenses, error } = await supabase
                .from('expenses')
                .select('*')
                .order('created_at', { ascending: false });

            const tableBody = document.getElementById('expense-table-body');
            tableBody.innerHTML = '';

            expenses.forEach(expense => {
                const row = `
                    <tr>
                        <td>${expense.expense_type}</td>
                        <td>${expense.amount}</td>
                        <td>${new Date(expense.created_at).toLocaleString()}</td>
                        <td>
                            <button onclick="editExpense(${expense.id})">Edit</button>
                            <button onclick="deleteExpense(${expense.id})">Delete</button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }

        // Render Analytics
        async function renderAnalytics() {
            const { data: orders } = await supabase.from('orders').select('*');
            const { data: expenses } = await supabase.from('expenses').select('*');

            // Order Chart
            const orderCtx = document.getElementById('order-chart').getContext('2d');
            new Chart(orderCtx, {
                type: 'bar',
                data: {
                    labels: orders.map(o => o.order_name),
                    datasets: [{
                        label: 'Order Amounts',
                        data: orders.map(o => o.amount),
                        backgroundColor: 'rgba(75, 192, 192, 0.6)'
                    }]
                }
            });

            // Expense Chart
            const expenseCtx = document.getElementById('expense-chart').getContext('2d');
            new Chart(expenseCtx, {
                type: 'pie',
                data: {
                    labels: expenses.map(e => e.expense_type),
                    datasets: [{
                        data: expenses.map(e => e.amount),
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.6)',
                            'rgba(54, 162, 235, 0.6)',
                            'rgba(255, 206, 86, 0.6)'
                        ]
                    }]
                }
            });
        }

        // Edit Order (Placeholder)
        function editOrder(id) {
            alert('Edit functionality to be implemented');
        }

        // Delete Order
        async function deleteOrder(id) {
            const { error } = await supabase
                .from('orders')
                .delete()
                .eq('id', id);

            if (error) {
                alert('Error deleting order: ' + error.message);
            } else {
                alert('Order deleted successfully!');
                fetchOrders();
            }
        }

        // Edit Expense (Placeholder)
        function editExpense(id) {
            alert('Edit functionality to be implemented');
        }

        // Delete Expense
        async function deleteExpense(id) {
            const { error } = await supabase
                .from('expenses')
                .delete()
                .eq('id', id);

            if (error) {
                alert('Error deleting expense: ' + error.message);
            } else {
                alert('Expense deleted successfully!');
                fetchExpenses();
            }
        }

        // Initial Load
        document.addEventListener('DOMContentLoaded', () => {
            showSection('order');
        });
    </script>
</body>
</html>
